# אפיון טכני - מערכת דיווח תקלות

## 1. מבוא

מערכת דיווח תקלות נועדה לאפשר למשתמשים לדווח על תקלות, לבקש הרשאות או להציע שיפורים למערכת. המערכת מתאימה למגוון רחב של משתמשים (משתמשים רגילים, מנהלים, וצוותים טכניים) ומאפשרת ניהול גמיש של סוגי הפניות והמודולים, שמירת נתונים למעקב וניתוח, והפקת דוחות וניתוח סטטיסטי (BI ראשוני) בצורה נוחה. המערכת תאפשר שימוש בסביבה גמישה כך שניתן יהיה להחליף שרתים ולבצע התאמות ללא שינוי קוד משמעותי.

## 2. מטרות המערכת

* **קלות שימוש:** טופס נגיש למילוי דיווחים עם חוויית משתמש נוחה ואינטואיטיבית.
* **גמישות דינמית:** התאמה לשינויים באמצעות קובץ קונפיגורציה.
* **תיעוד ושמירת מידע:** שמירת הנתונים למעקב וניתוח במסד נתונים או קובץ.
* **יצוא נתונים:** אפשרות ייצוא נתונים לקובץ Excel.
* **התאמה למספר מערכות שונות:** כל מערכת בעלת מודולים מותאמים.
* **מניעת דיווחים כפולים:** זיהוי כפילויות והתרעה מתאימה.
* **תמיכה בהחלפת שרתים:** קונפיגורציה דינמית לסביבות עבודה שונות.
* **הקטנת זמני תגובה:** שיפור תהליכי הטיפול בתקלות וטיפול מהיר בהן.
* **צירוף קבצים:** אפשרות העלאת קבצים נלווים לדיווח (צילומי מסך, קבצי לוג וכד').

## 3. מבנה כללי של המערכת

### 3.1. ממשק משתמש (Frontend)

ממשק המשתמש יתבסס על טכנולוגיות HTML, CSS, JavaScript (Vanilla/React) ויאפשר ממשק אינטואיטיבי שמאפשר למשתמשים ללא רקע טכני לבצע דיווחים בקלות ובנוחות:

* **טופס דיווח הכולל:**

   1. **שם מדווח** - שדה חופשי לקבלת טקסט מכל סוג.
   
   2. **תאריך דיווח** - **לא יוצג בטופס**, יתווסף אוטומטית בקובץ ה-Excel כ-Timestamp.
   
   3. **שם המערכת** - רשימה נפתחת עם שמות מערכות מתוך קובץ הקונפיגורציה.
   
   4. **סיבת הפנייה** - רשימה נפתחת עם 3 אפשרויות:
      * **תקלה** - יפתח שדה טקסט חופשי עם כותרת: "תיאור שחזור התקלה".
      * **בקשת הרשאות** - יפתח שדה טקסט חופשי עם כותרת: "הכנס בקשה מפורטת לקבלת הרשאה".
      * **הצעת ייעול** - יפתח שדה טקסט חופשי עם כותרת: "הכנס את הצעת הייעול בצורה מפורטת".
   
   5. **מודול מערכת** - הרשימה הנפתחת תשתנה בהתאם למערכת שנבחרה, הערכים נשמרים בקובץ הקונפיגורציה.
   
   6. **כפתור שליחת דיווח**
   
   7. **כפתור הורדת קובץ תקלות Excel**

* **התנהגות דינמית בטופס (Best Practices):**

   * **מדרג מילוי שדות חובה עם תלויות:**
     * טופס הדיווח יאלץ מילוי שדות בסדר לוגי עם הגבלות תלות:
     * **שלב ראשון:** מילוי "שם מדווח" - שדה חובה לפני המשך. כל השדות הבאים יהיו מושבתים.
     * **שלב שני:** אחרי מילוי שם המדווח, יופעל שדה "שם המערכת" לבחירה. שאר השדות עדיין מושבתים.
     * **שלב שלישי:** אחרי בחירת מערכת, יופעל שדה "סיבת הפנייה". שאר השדות עדיין מושבתים.
     * **שלב רביעי:** אחרי בחירת סיבת הפנייה, יופעל שדה "מודול מערכת" עם האפשרויות הרלוונטיות למערכת שנבחרה.
     * **שלב חמישי:** אחרי בחירת מודול, יופעל שדה הטקסט החופשי המתאים לסיבת הפנייה.
     * **שלב שישי:** רק לאחר מילוי כל השדות הנדרשים, יופעל כפתור "שלח דיווח".
   
   * **הצגת שדות חופשיים בהתאם לסיבת הפנייה:**
     * אם נבחרה "תקלה" יוצג שדה "תיאור שחזור התקלה".
     * אם נבחרה "בקשת הרשאות" יוצג שדה "הכנס בקשה מפורטת לקבלת הרשאה".
     * אם נבחרה "הצעת ייעול" יוצג שדה "הכנס את הצעת הייעול בצורה מפורטת".
     * במידה והמשתמש משנה את סוג הפנייה - השדה החופשי יתעדכן בהתאם **ורק הערך הרלוונטי יישמר**.

   * **סינון דינמי של מודול מערכת:**
     * הבחירות במודול יוצגו **בהתאם למערכת שנבחרה**.
     * ברירת מחדל - "בחר מודול...".

   * **טיפים למשתמש:**
     * שימוש ב-tooltips והסברים על השדות השונים בממשק המשתמש.
     * חיווי ויזואלי ברור כאשר שדה מושבת, כולל הסבר מדוע.

### 3.2. ממשק ניהול (Backend)

ממשק הניהול יתבסס על Node.js (Express.js) ויכלול:

* **API דינמי לקונפיגורציה** (טעינת נתונים מתוך `config.json`)
* **API לשמירת דיווחי תקלות** תוך בדיקת כפילות
* **API להורדת קובץ Excel** עם כל הדיווחים
* **תמיכה בבחירת שרת דינמית** בהתאם לסביבה (`local`, `production`)

## 4. מבנה הנתונים

### 4.1. קובץ קונפיגורציה (config.json)

```json
{
  "environments": {
    "local": "http://localhost:3000",
    "production": "https://defectreport.onrender.com"
  },
  "systems": [
    "google-maps",
    "google-drive",
    "google-translate",
    "google-sheets",
    "google-calendar",
    "google-chat",
    "google-photos",
    "google-somthing",
    "google-piknik",
    "google-coffe"
  ]
}
```

### 4.2. מבנה דיווחי תקלות (bugReports.json)

המערכת שומרת את הדיווחים בקובץ JSON:

```json
[
  {
    "reporterName": "שם המדווח",
    "systemName": "שם המערכת",
    "reason": "סיבת הפנייה",
    "module": "מודול המערכת",
    "description": "תיאור הבעיה או הבקשה",
    "timestamp": "2025-03-08T13:48:03.456Z"
  }
]
```

## 5. API Backend

### 5.1. נתיבים (Endpoints)

| מתודה | נתיב | תיאור |
|--------|--------|--------|
| GET | /config | שליפת קובץ הקונפיגורציה |
| POST | /submitBugReport | שמירת דיווח תקלה חדש |
| GET | /downloadExcel | הורדת כל הדיווחים בקובץ Excel |

### 5.2. פירוט הנתיבים

#### GET /config
- **תיאור**: מחזיר את קובץ הקונפיגורציה עם רשימת המערכות והמודולים
- **פרמטרים**: אין
- **אבטחה**: ללא הרשאות מיוחדות
- **תשובה**: קובץ JSON של הקונפיגורציה

#### POST /submitBugReport
- **תיאור**: שומר דיווח תקלה חדש
- **פרמטרים**: JSON עם פרטי הדיווח
- **אבטחה**: ולידציה בסיסית של השדות
- **גוף הבקשה**:
  ```json
  {
    "reporterName": "string",
    "systemName": "string",
    "reason": "string",
    "module": "string",
    "description": "string"
  }
  ```
- **תשובה**: סטטוס הצלחה/כישלון

#### GET /downloadExcel
- **תיאור**: מאפשר הורדת כל הדיווחים בקובץ Excel
- **פרמטרים**: אין
- **אבטחה**: ללא הרשאות מיוחדות
- **תשובה**: קובץ Excel להורדה

## 6. תהליך עבודה

1. המשתמש ממלא את טופס הדיווח לפי התהליך הליניארי:
   - מזין שם מדווח (שדה חובה)
   - בוחר את המערכת הרלוונטית (נפתח רק לאחר מילוי השדה הקודם)
   - בוחר את סיבת הפנייה (תקלה/בקשת הרשאות/הצעת ייעול)
   - בוחר את המודול הרלוונטי (מוצגות רק האפשרויות הרלוונטיות למערכת שנבחרה)
   - ממלא את שדה התיאור המתאים לסיבת הפנייה

2. המשתמש לוחץ על כפתור "שלח" (פעיל רק כשכל השדות מולאו).

3. המערכת מבצעת:
   - ולידציה בסיסית של הנתונים
   - שמירת הדיווח בקובץ JSON עם חותמת זמן אוטומטית
   - הצגת הודעת אישור למשתמש

4. מנהל המערכת או משתמש מורשה יכול:
   - להוריד את כל הדיווחים בקובץ Excel

## 7. שיקולים טכניים

### 7.1. תשתית ופיתוח

* **ניהול דינמי של קונפיגורציה** דרך config.json
* **תמיכה בדפדפנים מודרניים** Chrome, Edge, Firefox, Safari
* **תמיכה בגישה מניידים** באמצעות Responsive Design
* **החלפת שרתים** באמצעות הגדרות בקובץ קונפיגורציה

### 7.2. אבטחת מידע

* **ולידציית קלט בסיסית** למניעת הזרקת קוד זדוני
* **CORS** מוגדר לאפשר גישה מרובת מקורות
* **שימוש ב-JSON למידע רגיש** במקום מסד נתונים (לצרכי פיתוח)

### 7.3. ביצועים וזמינות

* **קוד קליינט קל** לטעינה מהירה
* **תגובות מהירות מהשרת** עם מינימום עיבוד
* **שמירת 100 רשומות אחרונות** למניעת גדילה לא מבוקרת של קובץ JSON

## 8. חוויית משתמש (UX)

### 8.1. ממשק טופס הדיווח

* **כיוון RTL** עבור תמיכה בעברית
* **סרגל התקדמות ויזואלי** המציג למשתמש באיזה שלב של התהליך הוא נמצא, עם 4 שלבים (שם מדווח, מערכת, סיבת פנייה, מודול)
* **שדות מושבתים** עם tooltip אינפורמטיבי כשלא ניתן להשתמש בהם
* **חיווי הצלחה** לאחר שליחת הטופס
* **ניקוי שדות** אוטומטי לאחר שליחה מוצלחת

### 8.2. עיצוב חזותי

* **עיצוב נקי** עם דגש על פונקציונליות
* **התאמה למובייל** עם רספונסיביות מלאה
* **צבעוניות מאוזנת** עם רקע בהיר ורכיבי טופס ברורים

## 9. פיתוחים עתידיים

* **הוספת מנגנון העלאת קבצים מצורפים** לדיווחים (צילומי מסך, קבצי לוג)
* **שיפור מערכת האימות וההרשאות** לגישה לדוחות Excel
* **הוספת ממשק למנהלים** לניהול וסינון דיווחים
* **שדרוג מסד הנתונים** למסד נתונים מבוסס SQL או MongoDB
* **פיתוח דשבורדים** לניתוח סטטיסטי של התקלות והדיווחים
* **הוספת תמיכה בהתראות** לתקלות קריטיות
* **שיפור ממשק המשתמש** עם מחוונים ויזואליים להתקדמות בטופס
* **הרחבת מגוון המערכות והמודולים** בקובץ הקונפיגורציה

## 10. סיכום

אפיון זה מגדיר מערכת דיווח תקלות בסיסית עם ממשק משתמש אינטואיטיבי, שמירת נתונים בפורמט JSON, ויכולת להורדת דוחות Excel. המערכת נבנתה כך שתהיה קלה לשימוש ולהרחבה, עם תמיכה בשפה העברית ובכיוון RTL. המערכת כוללת מנגנונים כמו ניהול סדר מילוי טופס, התאמת שדות דינמית, ושימוש בקובץ קונפיגורציה להגדרת מערכות ומודולים.

עם זאת, יש עדיין מקום לשיפורים והרחבות כמו הוספת מנגנון העלאת קבצים, שיפור מערכת האימות, והרחבת מסד הנתונים. מימוש השיפורים הללו יוכל להפוך את המערכת מפתרון בסיסי למערכת מקיפה ויעילה לניהול דיווחי תקלות בארגון.
