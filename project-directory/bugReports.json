fs.readFile('bugReports.json', (err, data) => {
  if (err) {
      return res.status(500).json({ error: "Error reading the file" });
  }
  let reports = [];
  try {
      reports = JSON.parse(data);
  } catch (parseError) {
      return res.status(500).json({ error: "Error parsing JSON" });
  }
  
  const ws = XLSX.utils.json_to_sheet(reports);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "Bug Reports");

  const excelFile = XLSX.write(wb, { bookType: "xlsx", type: "buffer" });
  res.setHeader('Content-Disposition', 'attachment; filename=bugReports.xlsx');
  res.setHeader('Content-Type', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
  res.send(excelFile);
});
